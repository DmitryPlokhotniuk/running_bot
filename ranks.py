from typing import Dict, Tuple, Optional

# Ранги пользователей: название ранга и диапазон километров (мин, макс) включительно
RANKS: Dict[str, Tuple[int, float]] = {
    "Падаван": (0, 10),
    "Рыцарь-джедай": (11, 30),
    "Мастер-джедай": (31, 50),
    "Ситх": (51, 70),
    "Лорд Ситхов": (71, float('inf'))
}

# Определение ранга на основе километража
def determine_rank(km: float) -> str:
    """
    Определяет ранг пользователя на основе километража за неделю
    """
    for rank, (min_km, max_km) in RANKS.items():
        if min_km <= km <= max_km:
            return rank
    return "Лорд Ситхов"  # По умолчанию, если что-то пошло не так

# Определение прогресса до следующего ранга
def calculate_progress(km: float) -> Tuple[str, Optional[str], Optional[float]]:
    """
    Рассчитывает прогресс до следующего ранга
    Возвращает: (текущий ранг, следующий ранг, км до следующего ранга)
    """
    current_rank = determine_rank(km)
    current_rank_names = list(RANKS.keys())
    current_rank_index = current_rank_names.index(current_rank)
    
    # Если это уже максимальный ранг
    if current_rank == "Лорд Ситхов":
        return current_rank, None, None
    
    next_rank = current_rank_names[current_rank_index + 1]
    next_rank_min = RANKS[next_rank][0]
    
    km_needed = next_rank_min - km
    return current_rank, next_rank, km_needed

# Задания для разных рангов
CHALLENGES = {
    "Падаван": [
        "Пробеги 3 км без остановки",
        "Пробеги 5 км за неделю",
        "Делай растяжку до и после каждой пробежки"
    ],
    "Рыцарь-джедай": [
        "Добавь интервальную тренировку в свой план",
        "Пробеги 5 км со средним темпом",
        "Выполни две пробежки в один день (утром и вечером)"
    ],
    "Мастер-джедай": [
        "Пробеги 10 км без остановки",
        "Выполни тренировку на холмистой местности", 
        "Присоединись к местному беговому сообществу"
    ],
    "Ситх": [
        "Пробеги полумарафонскую дистанцию за неделю",
        "Добавь темповую тренировку в свой план",
        "Пробеги 15 км в одну сессию"
    ],
    "Лорд Ситхов": [
        "Пробеги марафонскую дистанцию за неделю",
        "Запланируй участие в официальном забеге",
        "Проведи тренировку с другом и поделись своим опытом"
    ]
} 