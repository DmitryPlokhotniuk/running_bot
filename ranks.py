from typing import Dict, Tuple, Optional

# Ранги пользователей: название ранга и диапазон километров (мин, макс) включительно
RANKS: Dict[str, Tuple[int, float]] = {
    "Падаван": (0, 10),
    "Рыцарь-джедай": (11, 30),
    "Мастер-джедай": (31, 50),
    "Ситх": (51, 70),
    "Лорд Ситхов": (71, float('inf'))
}

# Определение ранга на основе километража
def determine_rank(km: float) -> str:
    """
    Определяет ранг пользователя на основе километража за неделю
    """
    for rank, (min_km, max_km) in RANKS.items():
        if min_km <= km <= max_km:
            return rank
    return "Лорд Ситхов"  # По умолчанию, если что-то пошло не так

# Определение прогресса до следующего ранга
def calculate_progress(km: float) -> Tuple[str, Optional[str], Optional[float]]:
    """
    Рассчитывает прогресс до следующего ранга
    Возвращает: (текущий ранг, следующий ранг, км до следующего ранга)
    """
    current_rank = determine_rank(km)
    current_rank_names = list(RANKS.keys())
    current_rank_index = current_rank_names.index(current_rank)
    
    # Если это уже максимальный ранг
    if current_rank == "Лорд Ситхов":
        return current_rank, None, None
    
    next_rank = current_rank_names[current_rank_index + 1]
    next_rank_min = RANKS[next_rank][0]
    
    km_needed = next_rank_min - km
    return current_rank, next_rank, km_needed

# Задания для разных рангов
CHALLENGES = {
    "Падаван": [
        "Пробеги 3 км без остановки — почувствуй уверенность в своих силах",
        "Пробеги 5 км за неделю — установи привычку к регулярным тренировкам",
        "Делай динамическую растяжку до и статическую растяжку после каждой пробежки — заботься о своём теле",
        "Добавь короткую разминку перед пробежкой (5 минут) для предотвращения травм",
        "Пробеги 2 раза по 2 км в течение недели — укрепляй выносливость"
    ],
    "Рыцарь-джедай": [
        "Добавь интервальную тренировку: 1 минута быстрого бега + 2 минуты медленного восстановления, повтори 5 раз",
        "Пробеги 5 км со средним темпом — улучшай свою скорость и выносливость",
        "Выполни две пробежки в один день (утром и вечером) — увеличивай объём тренировок",
        "Добавь силовую работу: приседания или выпады после пробежки для укрепления ног",
        "Используй музыку или подкасты, чтобы сделать бег более приятным"
    ],
    "Мастер-джедай": [
        "Пробеги 10 км без остановки — достигни нового уровня выносливости",
        "Выполни тренировку на холмистой местности или с уклонами для развития силы ног",
        "Присоединись к местному беговому сообществу или участвуй в групповых тренировках",
        "Добавь темповую пробежку: беги чуть быстрее обычного на 3-5 км",
        "Включи в план интервальные тренировки с разными скоростями для повышения скорости"
    ],
    "Ситх": [
        "Пробеги полумарафонскую дистанцию (21.1 км) за месяц — поставь амбициозную цель",
        "Добавь темповую тренировку: беги 8-10 км в быстром темпе, чуть медленнее спринта",
        "Пробеги 15 км за одну сессию — развивай выносливость и силу духа",
        "Проходи восстановительные тренировки: легкий бег или прогулка после интенсивных нагрузок",
        "Запишись на официальный забег или соревнование, чтобы получить мотивацию"
    ],
    "Лорд Ситхов": [
        "Пробеги марафонскую дистанцию (42.2 км) за месяц — вызов для настоящих джедаев",
        "Запланируй участие в крупном забеге или марафоне — ставь цель и готовься к нему заранее",
        "Проведи тренировку с другом или группой, делись опытом и поддержкой",
        "Внедри в план длительные пробежки на разные дистанции для разнообразия и подготовки к марафону",
        "Анализируй свои результаты: веди дневник тренировок и отслеживай прогресс"
    ]
}